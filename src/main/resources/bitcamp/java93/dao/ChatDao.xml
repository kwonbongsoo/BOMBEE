<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="bitcamp.java93.dao.ChatDao">

  <resultMap type="chat" id="chatMap">
    <id column='mno' property='memberno'/>
    <id column="tno" property="trainerno" />
    <result column="date" property="arrivedate" />
    <result column="msg" property="message" />
    <result column="confirm" property="confirm" />
    <result column="name" property="yourName" />
    <result column="timg" property="tPath"/>
    <result column="mimg" property="mPath"/>
    <collection property="noList" ofType="string">
      <result column="mno"/>
    </collection>
    <collection property="tnoList" ofType="string">
      <result column="tno"/>
    </collection>
  </resultMap>
  
  <select id="selectMemberAll" resultMap="chatMap" parameterType="int">
		select DISTINCT c.tno, c.mno, c.date, c.msg, c.confirm, m.name, m.img as timg
		from chat c  inner join memb m on c.tno = m.mno
		                inner join tcher t on c.tno = t.tno
		where c.mno = #{memberno}
		order by date desc;
  </select>
  
  <select id="selectTrainerAll" resultMap="chatMap" parameterType="int">
		select DISTINCT  c.mno, c.tno, c.date, c.msg, c.confirm, m.name, m.img as mimg
		from chat c inner join memb m on c.mno = m.mno
		where c.tno = #{trainerno}
		order by date desc;
  </select>
</mapper>
