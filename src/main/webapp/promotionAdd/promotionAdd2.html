<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="../node_modules/jquery-ui-dist/jquery-ui.css">
  <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.css">

  <link rel='stylesheet' href='../css/promotionAdd.css'>
  <link rel="stylesheet" href="../font-awesome/css/font-awesome.min.css">
  <link rel='stylesheet' href='../css/bombee.css'>
  <link rel='stylesheet' href='../css/menu.css'>

</head>

<body>
  <div class="projectAdd-container">
    <div class='header'></div>
    <!-- header -->

    <div class='projectAdd-top'>
      <div class='topClose' >
        <i class="fa fa-times" aria-hidden="true"></i>
      </div>

      <div class='temp'>
        <button class='tempText' disabled>임시글 0</button>
      </div>

      <div class='save' >
        등록
      </div>

      <div class='tempSave' >
        임시저장
      </div>
    </div>
    <!-- projectAdd-top -->

    <div class='projectAdd-input'>
      <input class='titleIn' type="text" placeholder="제 목">
    </div>
    <!-- projectAdd-title -->

    <div class='projectAdd-imageInput'>

        <div class='projectAdd-imageText'>
          <i class="fa fa-camera" aria-hidden="true"></i>
          <span>  &nbsp&nbsp프로모션 사진을 올려주세요</span>
        </div>
        <input type='file' id='image_upload' multiple>



      <div class='image-area' id='selectedFiles'>
        <div class='image-areaPlus'>
          <label for="image_upload">+</label>
        </div>

        <!-- <div class='image-areaPlus'>
          <img src=\"" + e.target.result + "\" data-file='"+f.name+"'  title='Click to remove'>
          <button class='selFile'></button>
        </div> -->

      </div>


    </div>

    <div class='projectAdd-date'>
      <input class='dateStart' type="text" id="datepicker-start" placeholder="시작 날짜 ">
      <input class='dateEnd' type="text" id="datepicker-end" placeholder="종료 날짜 "  required>
    </div>
    <!-- projectAdd-date -->

    <div class='projectAdd-input'>
      <input class='priceIn' type="number" placeholder="가 격">
    </div>
    <!-- projectAdd-price -->

    <div class='projectAdd-input'>
      <p class='addressCompany'></p>
    </div>

    <div class='projectAdd-input'>
      <p class='addressIn'></p>
    </div>

    <div class='projectAdd-textArea' >
      <textarea class='promotionText' placeholder="프로모션 내용을 등록해 주세요"></textarea>
    </div>
    <!-- projectAdd-textArea -->

  </div>
  <!-- container -->
  <script src='../node_modules/jquery/dist/jquery.min.js'></script>
  <script src="../node_modules/bootstrap/dist/js/bootstrap.js"></script>
  <script src='../node_modules/jquery-ui-dist/jquery-ui.min.js'></script>
  <script type="text/javascript" src="http://dapi.kakao.com/v2/maps/sdk.js?appkey=e93af6b0f8e2ad445bda7e9b6a416ad1&libraries=services"></script>
  <script src="../js/promotionAdd2.js"></script>
  <script>
  var textHeight = screen.availHeight-355-100;

  $(document).ready(function() {
    $('.header').load('../menu/new.html')
      console.log(textHeight + 'px');
    $('.projectAdd-textArea').css('height', textHeight+'px');

  })
  </script>



  <!-- image 처리 -->
  <script>
  var selDiv = "";
  var storedFiles = [];

  $(document).ready(function() {
    $("#image_upload").on("change", handleFileSelect);

    selDiv = $("#selectedFiles");
    // $("#myForm").on("submit", handleForm);

    $("body").on("click", ".selFile", removeFile);
  });

  function handleFileSelect(e) {

      var files = e.target.files;
      var filesArr = Array.prototype.slice.call(files);
      filesArr.forEach(function(f) {

        if(!f.type.match("image.*")) {
          return;
        }
        storedFiles.push(f);
        console.log(storedFiles);

        var reader = new FileReader();
        reader.onload = function (e) {
          var html = "<div class='image-areaPlus'><img src=\"" + e.target.result + "\" data-file='"+f.name+"'  title='Click to remove'><button class='selFile'></button> </div>";
          selDiv.append(html);
          // $(html).replaceAll('.ImageBtn');

        }
        reader.readAsDataURL(f);
      });


    }

    // function handleForm(e) {
    //   e.preventDefault();
    //   var data = new FormData();
    //
    //   for(var i=0, len=storedFiles.length; i<len; i++) {
    //     data.append('files', storedFiles[i]);
    //   }
    //
    //   var xhr = new XMLHttpRequest();
    //   xhr.open('POST', 'handler.cfm', true);
    //
    //   xhr.onload = function(e) {
    //     if(this.status == 200) {
    //       alert(e.currentTarget.responseText + ' items uploaded.');
    //     }
    //   }
    //
    //   xhr.send(data);
    // }

    function removeFile(e) {
      e.preventDefault();
      var file = $(this).data("file");

      for(var i=0;i<storedFiles.length;i++) {
        if(storedFiles[i].name === file) {
          storedFiles.splice(i,1);

          break;
        }
      }
      $(this).parent().remove();
    }

  </script>

</body>
</html>
