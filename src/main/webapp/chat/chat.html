<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.min.css">
  <link rel='stylesheet' href='../css/tomato.css'>
  <link rel='stylesheet' href='../css/chat.css'>
  <script src="../node_modules/jquery/dist/jquery.min.js"></script>
  <script src="../node_modules/handlebars/dist/handlebars.min.js"></script>
</head>
<body>
<div class='chat-container'>

  <div class='chat-body'>
    <div class='chat-header'>
      <span class="fa fa-times close-btn" aria-hidden="true"></span>
      <span class='chat-list'>목록</span>
    </div>
    <div class='chat-content' id='chat-container'>

    </div>
  </div>
</div>

<script id="chat-template" type="text/x-handlebars-template">
  {{#each chatList}}
  <div class='chat-line'>
    <div><img src='{{img}}' id='chat-user'/></div>
    <dl>
      <dt>{{name}}</dt>
      <dd>{{recentMsg}}</dd>
    </dl>
  </div>
  {{/each}}
</script>



<script type="text/javascript">

$.getJSON('chat.json', function(result) {
  // 템플릿 소스를 가지고 템플릿을 처리할 함수를 얻는다.
  var templateFn = Handlebars.compile($('#chat-template').text())
  var generatedHTML = templateFn(result) // 템플릿 함수에 데이터를 넣고 HTML을 생성한다.
  console.log(templateFn(result))
  var container = $('#chat-container')
  var html = container.html()
  container.html(html + generatedHTML) // 새 tr 태그들로 설정한다.
 })


</script>
</body>
</html>
